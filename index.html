<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>ì„ íƒì—°êµ¬ì†Œ | ê²°ì •ì¥ì•  ì¹˜ìœ  í”„ë¡œì íŠ¸</title>
  <meta name="description" content="ì •ë‹µì„ ì£¼ì§€ ì•ŠìŠµë‹ˆë‹¤. ë‹¹ì‹ ì˜ ë§ˆìŒê³¼ ì„ íƒì„ ì •ë¦¬í•´ë“œë¦½ë‹ˆë‹¤." />
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">

  <style>
    /* ë°ê³  ê¹¨ë—í•œ í…Œë§ˆ ë³€ìˆ˜ ì •ì˜ */
    :root {
      --bg: #f5f7fa;           /* ë°°ê²½: ì•„ì£¼ ë°ì€ íšŒìƒ‰ */
      --card: #ffffff;         /* ì¹´ë“œ: ê¹¨ë—í•œ í°ìƒ‰ */
      --text: #1a1f2c;         /* ë³¸ë¬¸ í…ìŠ¤íŠ¸: ì§„í•œ ì± ì½œ */
      --muted: #64748b;        /* ë³´ì¡° í…ìŠ¤íŠ¸: ì¤‘ê°„ íšŒìƒ‰ */
      --line: #e2e8f0;         /* í…Œë‘ë¦¬ ì„ : ì—°í•œ íšŒìƒ‰ */
      --accent: #0066ff;       /* í¬ì¸íŠ¸ ì»¬ëŸ¬: ì„ ëª…í•œ ë¸”ë£¨ */
      --accent-soft: #e6f0ff;  /* í¬ì¸íŠ¸ ë°°ê²½ìƒ‰ (ì—°í•œ ë¸”ë£¨) */
      --input-bg: #f8fafc;     /* ì…ë ¥ì°½ ë°°ê²½ */
      --shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.05), 0 2px 4px -1px rgba(0, 0, 0, 0.03); /* ë¶€ë“œëŸ¬ìš´ ê·¸ë¦¼ì */
      --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.05), 0 4px 6px -2px rgba(0, 0, 0, 0.025); /* í° ê·¸ë¦¼ì */
    }

    *{box-sizing:border-box}
    body{margin:0;font-family:'Inter', -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif; background:var(--bg); color:var(--text); line-height:1.6}
    .wrap{max-width:800px;margin:0 auto;padding:60px 20px 100px}

    /* Header */
    .header{text-align:center;margin-bottom:40px}
    h1{margin:0 0 12px;font-size:32px;font-weight:800;letter-spacing:-0.5px;color:var(--text);}
    .sub{color:var(--muted);font-size:16px; word-break: keep-all;}
    .pill{display:inline-block;margin-top:16px;padding:6px 14px;border:1px solid var(--line);border-radius:30px;font-size:12px;color:var(--muted);background:#fff; font-weight: 600;}

    /* Grid Layout */
    .grid{display:grid;gap:30px;grid-template-columns:1fr; align-items: start;}
    @media(min-width:768px){.grid{grid-template-columns:1fr 1fr}}

    /* Card Styles */
    .card{background:var(--card);border-radius:24px;padding:32px;box-shadow:var(--shadow-lg); border:1px solid rgba(255,255,255,0.5);}
    .card h2{margin:0 0 24px;font-size:20px;color:var(--text);display:flex;align-items:center;justify-content:space-between; font-weight: 700;}

    /* Inputs */
    label{display:block;color:var(--text);font-size:14px;margin-bottom:10px;font-weight:700}
    textarea,input{width:100%;background:var(--input-bg);border:1px solid var(--line);color:var(--text);border-radius:12px;padding:16px;font-size:15px;outline:none;transition:all 0.2s ease; font-family: inherit;}
    textarea::placeholder, input::placeholder {color: #a0aec0;}
    textarea:focus,input:focus{border-color:var(--accent); box-shadow: 0 0 0 3px var(--accent-soft); background: #fff;}
    textarea{min-height:140px;resize:none}

    /* Options & Emotions */
    .options{display:flex;flex-direction:column;gap:12px;margin-bottom:30px}
    .emotions{display:flex;flex-wrap:wrap;gap:10px;margin-bottom:30px}
    .chip{padding:10px 18px;border-radius:30px;border:1px solid var(--line);background:#fff;color:var(--muted);cursor:pointer;transition:all 0.2s;font-size:14px; font-weight: 600;}
    .chip:hover{background:var(--input-bg); border-color: #cbd5e1;}
    .chip[data-on="1"]{border-color:var(--accent);background:var(--accent);color:#fff;box-shadow: 0 4px 6px rgba(0, 102, 255, 0.2);}

    /* Buttons */
    .btn{width:100%;padding:16px;border-radius:14px;border:none;font-weight:700;font-size:16px;cursor:pointer;transition:all 0.2s;}
    .btnPrimary{background:var(--accent);color:#fff; box-shadow: 0 4px 6px rgba(0, 102, 255, 0.25);}
    .btnPrimary:hover{background:#0052cc; transform: translateY(-1px); box-shadow: 0 6px 8px rgba(0, 102, 255, 0.3);}
    .btnPrimary:active{transform: translateY(0);}
    .btnPrimary:disabled{background:var(--line);color:var(--muted);cursor:not-allowed; box-shadow: none; transform: none;}
    .btnGhost{background:transparent;border:2px solid var(--line);color:var(--muted);margin-top:12px}
    .btnGhost:hover{border-color:var(--muted);color:var(--text); background: var(--input-bg);}

    /* Results */
    .result-area{display:none} /* JSë¡œ í† ê¸€ */
    .block{background:var(--input-bg);border-radius:16px;padding:20px;margin-bottom:16px;border:1px solid var(--line);}
    .block h3{margin:0 0 10px;font-size:13px;color:var(--accent);text-transform:uppercase;letter-spacing:0.5px; font-weight: 700;}
    .block p, .block li{font-size:15px;color:var(--text);margin:0;line-height:1.65}
    .block ul{padding-left:20px;margin:0}
    .block li {margin-bottom: 6px;}

    /* Scores */
    .scores{display:grid;grid-template-columns:1fr 1fr;gap:12px;margin-top:24px}
    .scoreCard{background:#fff;padding:16px;border-radius:16px;text-align:center; border: 1px solid var(--line); box-shadow: var(--shadow);}
    .scoreLabel{font-size:12px;color:var(--muted);margin-bottom:6px; font-weight: 600;}
    .scoreVal{font-size:22px;font-weight:800;color:var(--accent);}

    /* Share Box */
    .share-box{background:linear-gradient(135deg, var(--accent) 0%, #0047b3 100%);border-radius:16px;padding:24px;text-align:center;margin-bottom:24px; color: #fff; box-shadow: 0 8px 16px rgba(0, 102, 255, 0.2);}
    .share-text{font-size:18px;font-weight:700;margin-bottom:16px;word-break:keep-all; line-height: 1.4;}
    .copy-btn{background:rgba(255,255,255,0.2);border:1px solid rgba(255,255,255,0.4);color:#fff;padding:8px 16px;border-radius:30px;font-size:13px;cursor:pointer; font-weight: 600; transition: 0.2s;}
    .copy-btn:hover {background:rgba(255,255,255,0.3);}

    /* Loader */
    .loader {width:20px;height:20px;border:3px solid rgba(255,255,255,0.3);border-bottom-color:#fff;border-radius:50%;display:inline-block;box-sizing:border-box;animation: rotation 1s linear infinite; vertical-align:middle; margin-right:8px; display:none;}
    @keyframes rotation {0% {transform: rotate(0deg)} 100% {transform: rotate(360deg)}}

    /* Status Badge */
    #statusBadge { background: var(--input-bg); padding: 4px 10px; border-radius: 20px; font-size: 12px; font-weight: 600; border: 1px solid var(--line);}

    .hidden{display:none !important}
  </style>
</head>
<body>

<div class="wrap">
  <div class="header">
    <h1>ì„ íƒì—°êµ¬ì†Œ</h1>
    <div class="sub">ì •ë‹µì„ ì£¼ì§€ ì•ŠìŠµë‹ˆë‹¤. ëŒ€ì‹ , ë‹¹ì‹ ì˜ ë§ˆìŒê³¼ ì„ íƒì„ <b>ëª…ì¾Œí•˜ê²Œ ì •ë¦¬</b>í•´ë“œë¦½ë‹ˆë‹¤.</div>
    <div class="pill">ë¬´ë£Œ MVP Â· ì €ì¥/ë¡œê·¸ì¸ ì—†ìŒ</div>
  </div>

  <div class="grid">
    <div class="card">
      <h2>ê³ ë¯¼ ì…ë ¥</h2>

      <label>1. ì§€ê¸ˆ ì–´ë–¤ ê³ ë¯¼ì„ í•˜ê³  ê³„ì‹ ê°€ìš”?</label>
      <textarea id="situation" placeholder="êµ¬ì²´ì ì¸ ìƒí™©ê³¼ ê³ ë¯¼ë˜ëŠ” ì§€ì ì„ ì ì–´ì£¼ì„¸ìš”. (ì˜ˆ: ì´ì§ ì œì•ˆì„ ë°›ì•˜ëŠ”ë° ì—°ë´‰ì€ ë†’ì§€ë§Œ ë„ˆë¬´ ë°”ì  ê²ƒ ê°™ì•„ ê³ ë¯¼ì´ì—ìš”...)"></textarea>

      <label style="margin-top:24px">2. ê³ ë ¤ ì¤‘ì¸ ì„ íƒì§€ (A vs B)</label>
      <div class="options">
        <input id="optA" placeholder="ì„ íƒ A ì…ë ¥ (ì˜ˆ: ì´ì§í•œë‹¤)">
        <input id="optB" placeholder="ì„ íƒ B ì…ë ¥ (ì˜ˆ: í˜„ ì§ì¥ì— ë‚¨ëŠ”ë‹¤)">
      </div>

      <label style="margin-top:24px">3. í˜„ì¬ ê°€ì¥ í¬ê²Œ ë“œëŠ” ê°ì •ì€?</label>
      <div class="emotions">
        <div class="chip" data-val="ë¶ˆì•ˆ">ë¶ˆì•ˆ</div>
        <div class="chip" data-val="ì„¤ë ˜">ì„¤ë ˜</div>
        <div class="chip" data-val="í˜¼ë€">í˜¼ë€</div>
        <div class="chip" data-val="ë‹µë‹µí•¨">ë‹µë‹µí•¨</div>
        <div class="chip" data-val="ë‘ë ¤ì›€">ë‘ë ¤ì›€</div>
      </div>

      <div style="margin-top: 32px;">
        <button class="btn btnPrimary" id="analyzeBtn">
            <span class="loader" id="loader"></span>
            <span id="btnText">ë¶„ì„í•˜ê¸°</span>
        </button>
        <button class="btn btnGhost" id="sampleBtn">ì˜ˆì‹œ ë°ì´í„°ë¡œ ì²´í—˜í•˜ê¸°</button>
      </div>
    </div>

    <div class="card" id="resultCardBox">
      <h2>ë¶„ì„ ê²°ê³¼ <span id="statusBadge" style="color:var(--muted)">ëŒ€ê¸° ì¤‘</span></h2>

      <div id="idleState" style="text-align:center; padding:60px 0; color:var(--muted)">
        <img src="https://cdn-icons-png.flaticon.com/512/10473/10473558.png" width="64" style="opacity:0.3; margin-bottom: 20px;">
        <p style="font-size: 16px; margin: 0;">ì™¼ìª½ì— ê³ ë¯¼ì„ ì…ë ¥í•˜ê³ <br><b>[ë¶„ì„í•˜ê¸°]</b> ë²„íŠ¼ì„ ëˆŒëŸ¬ì£¼ì„¸ìš”.</p>
      </div>

      <div id="resultArea" class="result-area">

        <div class="share-box">
          <div class="share-text" id="resShare">"ê²°ê³¼ëŠ”..."</div>
          <button class="copy-btn" id="copyShareBtn">ğŸ“‹ í•œ ì¤„ ìš”ì•½ ë³µì‚¬</button>
        </div>

        <div class="block">
          <h3>ğŸ§ ê°ì •ì˜ í•µì‹¬</h3>
          <p id="resEmotion"></p>
        </div>

        <div class="block">
          <h3>ğŸ’¡ ë°œê²¬ëœ íŒ¨í„´</h3>
          <p id="resPattern"></p>
        </div>

        <div class="block" style="border-color: #fecaca; background: #fff5f5;">
          <h3 style="color: #dc2626;">âš ï¸ ì²´í¬í•  ë¦¬ìŠ¤í¬</h3>
          <ul id="resRisks" style="color: #991b1b;"></ul>
        </div>

        <div class="block" style="border-color: #bbf7d0; background: #f0fdf4;">
          <h3 style="color: #16a34a;">ğŸš€ ì¶”ì²œ ê°€ì´ë“œ</h3>
          <p id="resRec" style="color: #166534; font-weight: 600;"></p>
        </div>

        <div class="block">
          <h3>ğŸ’Œ ë¯¸ë˜ì˜ ë©”ì‹œì§€</h3>
          <p id="resFuture"></p>
        </div>

        <div class="scores">
          <div class="scoreCard"><div class="scoreLabel">ì‹¤í–‰ ê°€ëŠ¥ì„±</div><div class="scoreVal" id="scFeas">-</div></div>
          <div class="scoreCard"><div class="scoreLabel">ê°ì • ê°œì…ë„</div><div class="scoreVal" id="scEmo">-</div></div>
          <div class="scoreCard"><div class="scoreLabel">í›„íšŒ í™•ë¥ </div><div class="scoreVal" id="scReg">-</div></div>
          <div class="scoreCard"><div class="scoreLabel">ë¦¬ìŠ¤í¬ ë¯¼ê°ë„</div><div class="scoreVal" id="scRisk">-</div></div>
        </div>

        <button class="btn btnGhost" id="resetBtn" style="margin-top:24px">ë‹¤ì‹œ ì…ë ¥í•˜ê¸°</button>
      </div>
    </div>
  </div>
</div>

<script>
  const $ = (s) => document.querySelector(s);
  let selectedEmotion = null;

  // ê°ì • ì„ íƒ ë¡œì§
  document.querySelectorAll('.chip').forEach(el => {
    el.addEventListener('click', () => {
      document.querySelectorAll('.chip').forEach(c => c.dataset.on = "0");
      el.dataset.on = "1";
      selectedEmotion = el.dataset.val;
    });
  });

  // ìƒ˜í”Œ ì±„ìš°ê¸°
  $('#sampleBtn').addEventListener('click', () => {
    $('#situation').value = "ì—°ë´‰ì€ ë†’ì€ë° ë„ˆë¬´ ë°”ìœ ìŠ¤íƒ€íŠ¸ì—…ìœ¼ë¡œ ì´ì§í• ì§€, ì§€ê¸ˆ ë‹¤ë‹ˆëŠ” ì•ˆì •ì ì¸ ëŒ€ê¸°ì—…ì— ë‚¨ì„ì§€ ê³ ë¯¼ì…ë‹ˆë‹¤. ê²°í˜¼ ì¤€ë¹„ë„ í•´ì•¼ í•´ì„œ ì‹œê°„ì´ í•„ìš”í•œë° ëˆë„ í•„ìš”í•´ìš”.";
    $('#optA').value = "ìŠ¤íƒ€íŠ¸ì—…ìœ¼ë¡œ ì´ì§ (ë„ì „, ê³ ì—°ë´‰, ë°”ì¨)";
    $('#optB').value = "ëŒ€ê¸°ì—… ì”ë¥˜ (ì•ˆì •, ì›Œë¼ë°¸, ì„±ì¥ì •ì²´)";
    document.querySelectorAll('.chip')[2].click(); // í˜¼ë€

    // ì‚¬ìš©ì í¸ì˜ë¥¼ ìœ„í•´ ìŠ¤í¬ë¡¤ ì´ë™
    $('#analyzeBtn').scrollIntoView({behavior: "smooth", block: "center"});
  });

  // ì´ˆê¸°í™”
  $('#resetBtn').addEventListener('click', () => {
    $('#resultArea').style.display = 'none';
    $('#idleState').style.display = 'block';
    $('#statusBadge').innerText = "ëŒ€ê¸° ì¤‘";
    $('#statusBadge').style.color = "var(--muted)";
    $('#statusBadge').style.background = "var(--input-bg)";

    $('#situation').value = "";
    $('#optA').value = "";
    $('#optB').value = "";
    document.querySelectorAll('.chip').forEach(c => c.dataset.on = "0");
    selectedEmotion = null;

    window.scrollTo({ top: 0, behavior: 'smooth' });
  });

  // ë¶„ì„í•˜ê¸° ë²„íŠ¼ í´ë¦­
  $('#analyzeBtn').addEventListener('click', async () => {
    const situation = $('#situation').value.trim();
    const optA = $('#optA').value.trim();
    const optB = $('#optB').value.trim();

    if(!situation || !optA || !optB || !selectedEmotion) {
      alert("ğŸ’¡ ëª¨ë“  ë‚´ìš©ì„ ì…ë ¥í•˜ê³  ê°ì •ì„ ì„ íƒí•´ì£¼ì„¸ìš”!");
      return;
    }

    // ë¡œë”© ìƒíƒœ ì „í™˜
    const btn = $('#analyzeBtn');
    const loader = $('#loader');
    const btnText = $('#btnText');

    btn.disabled = true;
    loader.style.display = 'inline-block';
    btnText.innerText = "ì—´ì‹¬íˆ ë¶„ì„ ì¤‘...";
    $('#statusBadge').innerText = "ë¶„ì„ ì§„í–‰ ì¤‘...";
    $('#statusBadge').style.color = "var(--accent)";
    $('#statusBadge').style.background = "var(--accent-soft)";

    // ëª¨ë°”ì¼ì—ì„œ ê²°ê³¼ ì˜ì—­ì´ ë³´ì´ë„ë¡ ì‚´ì§ ìŠ¤í¬ë¡¤
    if(window.innerWidth < 768) {
        $('#resultCardBox').scrollIntoView({behavior: "smooth", block: "start"});
    }

    try {
      const res = await fetch('/api/analyze', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({
          situation,
          options: [optA, optB],
          emotion: selectedEmotion
        })
      });

      if(!res.ok) throw new Error("ì„œë²„ì™€ í†µì‹  ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.");

      const data = await res.json();
      renderResult(data);

    } catch (e) {
      console.error(e);
      alert("ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤: " + e.message);
      $('#statusBadge').innerText = "ì˜¤ë¥˜ ë°œìƒ";
      $('#statusBadge').style.color = "#dc2626";
    } finally {
      // ë¡œë”© í•´ì œ
      btn.disabled = false;
      loader.style.display = 'none';
      btnText.innerText = "ë¶„ì„í•˜ê¸°";
    }
  });

  function renderResult(data) {
    $('#idleState').style.display = 'none';
    $('#resultArea').style.display = 'block';
    $('#statusBadge').innerText = "ë¶„ì„ ì™„ë£Œ!";
    $('#statusBadge').style.color = "#16a34a"; // green
    $('#statusBadge').style.background = "#dcfce7"; // light green bg

    $('#resShare').innerText = data.share_summary || "ë‚˜ì˜ ì„ íƒ, ì •ë¦¬ê°€ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤.";
    $('#resEmotion').innerText = data.emotion_summary;
    $('#resPattern').innerText = data.pattern_analysis;
    $('#resRec').innerText = data.recommendation;
    $('#resFuture').innerText = data.future_message;

    // ë¦¬ìŠ¤í¬ ë¦¬ìŠ¤íŠ¸ ë Œë”ë§
    const riskHtml = data.risks.map(r => `<li>${r}</li>`).join('');
    $('#resRisks').innerHTML = riskHtml;

    // ì ìˆ˜ ë Œë”ë§
    $('#scFeas').innerText = data.scores.feasibility;
    $('#scEmo').innerText = data.scores.emotion_influence;
    $('#scReg').innerText = data.scores.regret_probability + "%";
    $('#scRisk').innerText = data.scores.risk_sensitivity;

    // ê²°ê³¼ ìª½ìœ¼ë¡œ ìŠ¤í¬ë¡¤ ì´ë™
    $('#resultCardBox').scrollIntoView({behavior: "smooth", block: "start"});
  }

  // í•œ ì¤„ ìš”ì•½ ë³µì‚¬
  $('#copyShareBtn').addEventListener('click', () => {
    const text = $('#resShare').innerText;
    // ì‹¤ì œ ë°°í¬ ì£¼ì†Œë¡œ ë³€ê²½ í•„ìš”
    const url = window.location.origin;
    navigator.clipboard.writeText(`[ì„ íƒì—°êµ¬ì†Œ] ${text}\nğŸ‘‰ ë‚˜ë„ ì •ë¦¬í•˜ëŸ¬ ê°€ê¸°: ${url}`);

    const originalText = $('#copyShareBtn').innerText;
    $('#copyShareBtn').innerText = "âœ… ë³µì‚¬ì™„ë£Œ!";
    setTimeout(() => {
        $('#copyShareBtn').innerText = originalText;
    }, 2000);
  });
</script>

</body>
</html>
